
[TOC]


## 25 分布式系统关键技术：服务调度
关键点：
服务关键程度
服务依赖关系
服务发现
整个架构的版本管理
服务应用生命周期全管理

## 流量与数据调度
流量调度关键技术：
- 高性能
- 扛流量
- 业务逻辑
- 服务化

以上4个特性，其实主要是在说API网关应该具备的特点。

#### 分布式事务一致性问题
数据副本是分布式解决数据丢失异常的唯一解决手段。
解决方案：
- Master/Slave
- Master/Master
- 两阶段与三阶段提交方案
- Paxos方案

应用层解决事务问题：两阶段提交
数据层解决事务问题：Paxos算法


## 27 洞悉PaaS平台的本质
首先还是抛出问题吧：
**为了构建一个分布式系统，我们面临的主要问题有:**
- 故障是常态，需要运维流程自动化
- 良好的服务设计，避免单点故障
- 容量的可伸缩性
- 老的服务可能是异构的，需要让它们使用标准化的协议
- 分布式存储使得事务处理变得复杂，事务无法自动恢复时，手工恢复将会很复杂
- 测试和查错的复杂度增大
- 系统吞度量会变大，但同时响应时间会变长

为了解决这些问题，了解了如下解决方案：
- 完善的监控系统
- 设计服务时要分析其依赖链
- 重构老的软件，使其服务化
- 为老的服务编写接口逻辑，以便使用标准协议，或必要时重构老的服务
- 自动构建服务的依赖地图
- 使用API网关
- 事务处理建议在存储层实现；根据业务需求，或是降级使用更简单、吞吐量更大的最终一致性方案，或是通过二阶段提交、paxos、raft、NWR等方案之一，使用吞吐量小的强一致性方案
- 异步调用；关键服务采用专属硬件资源，优化软件逻辑
  

## 41 弹力设计篇之“认识故障和弹力设计”
分布式系统中，可能出现多种问题，不出现故障基本不可能，需要考虑出现故障时如何尽快修复故障。
可能出现的故障主要有：
- 网络问题
- 性能问题
- 安全问题
- 运维问题
- 管理问题
- 硬件问题
  
故障不可避免，就需要**把处理故障的代码当成正常的功能做在架构里写在代码里**

左耳朵耗子叔这里说的弹力设计 Resiliency 主要是指：
- 好的情况下，系统出现故障后，能够自动修复，不需要人为介入
- 如果修复不了，系统能够自我保护，不让事态变得更糟

## 42 弹力设计篇之“隔离设计”
隔离设计所要解决的问题：发生故障时使故障隔离，不要导致系统整体不可用，减小影响范围
分离的方式：
- 以服务的种类来做分离
  - 异步处理，两阶段提交
- 以用户的请求来做分离
  - 多租户架构
